var econCal=new function(){var i="en";if("string"==typeof fxcmcom.base_path)switch(fxcmcom.base_path.slice(1,-1)){case"uk":moment.locale("uk");break;case"au":moment.locale("au");break;case"de":moment.locale("de"),i="de";break;case"fr":moment.locale("fr"),i="fr";break;case"it":moment.locale("it"),i="it";break;case"es":moment.locale("es"),i="es"}var p=["AUD","CAD","CHF","CNY","EUR","GBP","JPY","MXN","NOK","NZD","SEK","TRY","USD","ZAR"],d=$(),o=function(e){if("string"!=typeof e)return!1;return/^[0-9]{4}-[0-1][0-9]-[0-3][0-9]$/.test(e)};this.initCalendar=function(e){if(d=$(e),!fxcm.lib.isJqueryElement(d))return!1;var t=moment().startOf("d").subtract(1,"d"),n=moment(t).add(5,"d");!function(e,t,n){if(!o(e)||!o(t))return;var a={contenttype:"economiccalendar",language:i,format:"json",description:"true",startdate:e.split("-").join(""),enddate:t.split("-").join(""),t:Date.now()};d.addClass("loading"),$.getJSON("https://content.fxcm.news/getData",a).done(function(e){"function"==typeof n&&n(e),d.removeClass("loading")}).fail(function(){console.log("Error: Calendar data could not be retrieved")})}(t.format("YYYY-MM-DD"),n.format("YYYY-MM-DD"),function(e){!function(e){if(d.empty(),"object"!=typeof e||!e.length)return d.html('<div class="grid-100 bg-medium-dark-grey"><p class="txt-white padding-vertical-10 margin-0">No events found</p></div>');for(var t,n,a,i,o,r,c='<dl class="cal-list">',s=moment(),l=0;l<e.length;l++)n=moment(e[l].dateTime),moment.isMoment(t)&&!n.isAfter(t,"day")||(0<l&&(c+="</div>"),c+='<div class="day-wrap"><h5 class="day-title"><span>'+(t=n).format("dddd, MMMM DD YYYY")+"</span></h5>"),a=n.diff(s)<0?"event-expired":"",i=e[l].importance&&"NA"!==e[l].importance?e[l].importance.toLowerCase():"none",o="string"==typeof e[l].eventPeriod&&e[l].eventPeriod.length?" ("+e[l].eventPeriod+")":"",r="string"==typeof e[l].description&&e[l].description.length?e[l].description:"N/A",c+='<dt class="'+a+'"><ul class="reset event-summary"><li class="time"><span>'+n.format("HH:mm")+'</span></li><li class="currency">'+e[l].currency+'</li><li class="title"><span class="flag-icon flag-icon-'+e[l].countryCode+'" />'+e[l].name+o+'</li><li class="volatility"><div title="'+e[l].importance+'" class="volatility-ind '+i+'"></div></li></ul></dt><dd class="clearfix"><div class="event-details"><div class="padding-top-20 padding-horizontal-20"><p>'+r+"</p></div></div></dd>";c+="</div></dl>",d.append(c),new fxcm.ui.ExpandableSet(d.find("dt")),d.find(".has-tooltip").each(function(){new fxcm.Tooltip(this)})}(function(e,t,n){if("object"!=typeof e||"object"!=typeof t||!t.length)return!1;e.currency=e.currency||p,e.volatility&&(e.importance=e.volatility,delete e.volatility),e.category&&(e.eventType=e.category,delete e.category);for(var a=[],i="number"==typeof n?n:0,o=moment(),r=0;r<t.length;r++){var c=moment(t[r].dateTime),s=0,l=0,d=parseInt(c.format("YYYYMMDD"));if(!c.isBefore(o)){for(var m in e)if(e[m].length)switch(s++,m){case"rangeStart":parseInt(e.rangeStart.split("-").join(""))<=d&&l++;break;case"rangeEnd":d<=parseInt(e.rangeEnd.split("-").join(""))&&l++;break;case"keyword":var f=RegExp(e[m],"gi");(-1<t[r].name.search(f)||"string"==typeof t[r].description&&-1<t[r].description.search(f))&&l++;break;case"importance":(-1<e[m].indexOf("None")&&(!t[r][m]||"NA"===t[r][m])||-1<e[m].indexOf(t[r][m]))&&l++;break;default:"object"==typeof t[r]&&-1<e[m].indexOf(t[r][m])&&l++}if(l===s&&(t[r].countryCode="EMU"===t[r].countryCode?"eu":t[r].countryCode.toLowerCase(),a.push(t[r])),i&&a.length===i)break}}return a.sort(function(e,t){if("object"!=typeof e||!e.dateTime||"object"!=typeof t||!t.dateTime)return 0;var n=" .,!?:$%#@*&()/-_0123456789abcdefghijklmnopqrstuvwxyz".split(""),a=0,i=0;function makeDateNum(e){return parseInt(e.substr(0,10).split("-").join("")+e.substr(11,8).split(":").join(""))}for(a=makeDateNum(e.dateTime)-makeDateNum(t.dateTime);0===a&&i<e.name.length&&i<t.name.length;)a=n.indexOf(e.name.charAt(i).toLowerCase())-n.indexOf(t.name.charAt(i).toLowerCase()),i++;return a}),a}({},e,8))})}};jQuery(document).ready(function(e){econCal.initCalendar(e("#economic-calendar"))});
//# sourceMappingURL=economic-calendar-small.min.js.map
